y = 116648332177306174017527127549190153848047855434017613911755999276662547039247996096557038008074357356998369121795639727722770171501474635919261498816632591359222624885024271075382098186379653617114137047973089044035209343295409523780013307302522024049809482703193730088048487227712339952205361979863701600395
g = 104966517728685087179378968429882722243488831429721501338630188511862079324027125625127510260558510190997730307658824834065501603691740018655716569628794703723230383916846194476736477080530854830949602331964368460379499906708918619931510098049428214265197988340769025692636078178747920567974784781276951968008
p = 132647637373924126304737056158675239668569042130007927942219289722425653810759509902584847060887833765602300347356269818247885095191932142142158141685415445666121487376072977219649442049465897758913398696622311560182645289221066659021644772377778633906480501432034182625478603512574236522463497264896323207471
q = 834233754607844004570804297965577358375283559517

n_a = 864337018519190491905529980744
c_a = 536243723865963036490538290474
m_a = 1063010345787496234374101456994

n_b = 813460733623680327018793997863
c_b = 68174629230356751334120213815
m_b = 149969575537638328028522091955

k_a = 1236621443694604088636495657553
k_b = 360116617412226281615057993787
c = 557068474970796394723013869302
m = 621722243779663917170959398660

r1 = 168550445538394390892208022929685543728094150443
s1 = 576254520012817791068233393305521440457280594717
# int(sha1('the rules are the rules, no complaints').hexdigest(), 16)
h1 = 793725469310789348222479757421998121556400233934

r2 = 784029366978352581089654823029116771569792200932
s2 = 442349672388377677760805876152979278711970359339
# int(sha1('reyammer can change the rules').hexdigest(), 16)
h2 = 1210355292753685250384193544060067285345572343981L

A = (s1 * inverse_mod(r1, q)) % q
B = (s2 * inverse_mod(r2, q)) % q
C = (h1 * inverse_mod(r1, q) - h2 * inverse_mod(r2, q)) % q

k1, k2 = var('k1,k2')
model = solve_mod([A * k1 - B * k2 == C, k2 == (k_a * ((n_a * k1 + c_a) % m_a) + k_b * ((n_b * k1 + c_b) % m_b) + c) % m], q)
